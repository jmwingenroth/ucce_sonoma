---
title: "IDW model for short-term and long-term sensors"
author: "Jordan Wingenroth"
date: "May 31, 2018"
output: html_document
---

```{r knitr opts, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)

```

```{r libraries}

library(tidyverse)

```

# geographic data setup

```{r load geographic data}

aq_sensors <- read_csv(file = "data/aq_sensors.csv")
farms <- read_csv(file = "data/farm_data.csv")
hysplit <- readxl::read_xlsx(path = "data/HYSPLIT_data.xlsx")

all(sort(hysplit$Address)==sort(farms$address))
    
```

```{r tidy geographic data}

#farm

farms <- left_join(farms, hysplit, by = c("address" = "Address"))

farms <- farms %>%
  select(address, Key, long, lat, `Exposure (raw, final model, normalized)`, `Exposure (smoothed, final model, normalized)`, `Rank (raw)`, `Rank (smoothed)`)

rm(list = "hysplit")

#aq_sensors

colnames(aq_sensors)[3:4] <- c("lat", "long")

```

# map with farm sites and aq sensors

```{r map, fig.width=8, fig.height=8}

ggplot(NULL, aes(long, lat)) +
  geom_point(data = aq_sensors) +
  geom_text(data = aq_sensors, color = "black", alpha = .3, aes(label = name), hjust = "inward", vjust = "inward", size = 3) +
  geom_point(data = farms, color = "red") +
  geom_text(data = farms, color = "red", alpha = .3, aes(label = Key), hjust = "inward", vjust = "inward", size = 3) +
  coord_fixed(xlim = c(-123, -122.5), ylim = c(38.15, 38.65))

```

We're lacking sensors to the northwest of the sites, but we have a good number to the southeast (Vacaville, Vallejo, Berkeley, SF, Oakland).

# PM 2.5 data setup

# graphs of sensor data

# model function

# run model

# plots